<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Progress Tracker (3 Students + Benchmark)</title>

    <style>
        :root{
          --bg:#0b1020;
          --card:#12172a;
          --muted:#9aa3b2;
          --text:#e6eaf2;
          --radius:16px;
          --shadow:0 10px 30px rgba(0,0,0,.35);
        }
        *{box-sizing:border-box}
        body{
          margin:0;
          font-family:system-ui;
          background:radial-gradient(1000px 600px at 20% 0%, #121936 0,#0b1020 60%);
          color:var(--text);
        }
        .container{max-width:1100px;margin:32px auto;padding:0 16px}
        header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px}
        header h1{margin:0;font-size:28px}

        .legend{display:flex;gap:8px;flex-wrap:wrap}
        .tag{display:flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#0f1530;border:1px solid rgba(255,255,255,.08)}
        .dot{width:10px;height:10px;border-radius:50%}

        .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px;margin-top:16px}
        @media(max-width:900px){.grid{grid-template-columns:1fr}}

        .card{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
        h2{margin-top:0}

        .row{display:flex;gap:12px;flex-wrap:wrap}
        .field{flex:1;min-width:140px}
        label{font-size:12px;color:var(--muted)}
        input,button{padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,.08);background:#0f1530;color:var(--text)}
        button{cursor:pointer}

        .chart-wrap{position:relative;height:280px}
        #chart{width:100%!important;height:100%!important}

        table{width:100%;border-collapse:collapse}
        th,td{padding:8px;border-bottom:1px solid rgba(255,255,255,.08);text-align:left}
        th{color:var(--muted)}
    </style>
</head>

<body>
<div class="container">

    <header>
        <h1>Progress Tracker</h1>
        <div class="legend">
            <span class="tag"><span class="dot" style="background:#7c9cff"></span>Shantha</span>
            <span class="tag"><span class="dot" style="background:#55d6a9"></span>Sairam</span>
            <span class="tag"><span class="dot" style="background:#ffd166"></span>Umesh</span>
            <span class="tag"><span class="dot" style="background:#ff7a8a"></span>Benchmark</span>
        </div>
    </header>

    <div class="grid">

        <!-- Chart -->
        <section class="card">
            <h2>Growth Index</h2>
            <div class="chart-wrap">
                <canvas id="chart"></canvas>
            </div>
        </section>

        <!-- Criteria -->
        <section class="card">
            <h2>Performance Criteria</h2>
            <table>
                <tr><td>9 - 10</td><td>Exceptional Performance</td></tr>
                <tr><td>6 – 9</td><td>On Track - Keep Going</td></tr>
                <tr><td>5 - 6</td><td>Moderate – Needs Improvement</td></tr>
                <tr><td>3 – 5</td><td>Underperforming – High Risk</td></tr>
                <tr><td>1 – 3</td><td>Critical – Exit Consideration</td></tr>
                <tr><td>0</td><td>Removed from Team</td></tr>
            </table>
        </section>

        <!-- Average -->
        <section class="card">
            <h2>Current Average Score</h2>
            <div class="row">
                <div class="tag">Shantha: <strong id="avg1">–</strong></div>
                <div class="tag">Sairam: <strong id="avg2">–</strong></div>
                <div class="tag">Umesh: <strong id="avg3">–</strong></div>
                <div class="tag">Benchmark: <strong id="avgBm">–</strong></div>
            </div>
        </section>

        <!-- Form -->
        <section class="card">
            <h2>Add / Update Scores</h2>
            <form id="form">
                <div class="row">
                    <div class="field"><label>Sprint</label><input id="label" required></div>
                </div>
                <div class="row">
                    <div class="field"><label>Shantha</label><input id="s1" type="number" required></div>
                    <div class="field"><label>Sairam</label><input id="s2" type="number" required></div>
                    <div class="field"><label>Umesh</label><input id="s3" type="number" required></div>
                    <div class="field"><label>Benchmark</label><input id="bm" type="number" required></div>
                </div>
                <div class="row" style="margin-top:10px">
                    <button>Add</button>
                    <button type="button" id="exportBtn">Export JSON</button>
                    <button type="button" id="importBtn">Import JSON</button>
                    <input type="file" id="importFile" hidden>
                </div>
            </form>
        </section>

        <!-- Table -->
        <section class="card" style="grid-column:1/-1">
            <h2>Score Table</h2>
            <table id="table">
                <thead>
                <tr><th>Sprint</th><th>Shantha</th><th>Sairam</th><th>Umesh</th><th>Benchmark</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </section>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let data={labels:[],s1:[],s2:[],s3:[],bm:[]};
    let chart;

    const avg=(a)=>a.length?(a.reduce((x,y)=>x+y,0)/a.length).toFixed(2):"–";

    function renderAverages(){
      avg1.textContent=avg(data.s1);
      avg2.textContent=avg(data.s2);
      avg3.textContent=avg(data.s3);
      avgBm.textContent=avg(data.bm);
    }

    function renderTable(){
      table.querySelector("tbody").innerHTML=data.labels.map((l,i)=>
        `<tr><td>${l}</td><td>${data.s1[i]}</td><td>${data.s2[i]}</td><td>${data.s3[i]}</td><td>${data.bm[i]}</td></tr>`
      ).join("");
    }

    async function init(){
      const saved=localStorage.getItem("student-data");
      if(saved) data=JSON.parse(saved);
      else{
        try{
          const r=await fetch("data.json",{cache:"no-store"});
          if(r.ok) data=await r.json();
        }catch{}
      }

      chart=new Chart(chartCanvas,{
        type:"line",
        data:{labels:data.labels,datasets:[
          {label:"Shantha",data:data.s1,borderColor:"#7c9cff",tension:.3},
          {label:"Sairam",data:data.s2,borderColor:"#55d6a9",tension:.3},
          {label:"Umesh",data:data.s3,borderColor:"#ffd166",tension:.3},
          {label:"Benchmark",data:data.bm,borderColor:"#ff7a8a",borderDash:[5,5],tension:.3}
        ]},
        options:{responsive:true,maintainAspectRatio:false}
      });

      renderTable();
      renderAverages();
    }

    form.onsubmit=e=>{
      e.preventDefault();
      data.labels.push(label.value);
      data.s1.push(+s1.value);
      data.s2.push(+s2.value);
      data.s3.push(+s3.value);
      data.bm.push(+bm.value);

      localStorage.setItem("student-data",JSON.stringify(data));
      chart.update();
      renderTable();
      renderAverages();
      form.reset();
    };

    exportBtn.onclick=()=>{
      const b=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
      const a=document.createElement("a");
      a.href=URL.createObjectURL(b);
      a.download="students-growth-data.json";
      a.click();
    };

    importBtn.onclick=()=>importFile.click();
    importFile.onchange=e=>{
      const r=new FileReader();
      r.onload=ev=>{
        data=JSON.parse(ev.target.result);
        localStorage.setItem("student-data",JSON.stringify(data));
        chart.data.labels=data.labels;
        chart.data.datasets[0].data=data.s1;
        chart.data.datasets[1].data=data.s2;
        chart.data.datasets[2].data=data.s3;
        chart.data.datasets[3].data=data.bm;
        chart.update();
        renderTable();
        renderAverages();
      };
      r.readAsText(e.target.files[0]);
    };

    const chartCanvas=document.getElementById("chart");
    init();
</script>
</body>
</html>
